1 — Shared setup tasks (do these first)

Create or confirm an api utility:

src/lib/api.ts exporting apiClient (axios) preconfigured with baseURL = import.meta.env.VITE_API_BASE.

Add interceptor to attach Authorization: Bearer <token> from authStore (in-memory or localStorage).

Create auth state store:

src/stores/authStore.ts (Zustand or React Context).

Expose: user, token, setAuth({user, token}), clearAuth(), isAuthenticated.

Persist token (optionally) in localStorage under key docmanager:accessToken. On app init, load token and call /auth/me if available (or rely on decoded token).

Add route guards:

PrivateRoute wrapper that redirects to /login when not authenticated.

Ensure VITE_API_BASE env is configured in Netlify for build and locally .env.

Create reusable UI components:

Input, Button, Form, Card, Toast, PageHeader.

Add client-side validator util:

src/lib/validators.ts (email regex, password strength).

2 — Register page (/auth/register)
Purpose

Allow new users to sign up. After successful registration auto-login (if backend returns tokens) or redirect to login page with success message.

Components & files

src/pages/auth/Register.tsx

components/AuthForm.tsx (reusable for login/register)

components/PasswordStrengthMeter.tsx (optional)

Use Tailwind classes & theme tokens.

Form fields & UI

Name (text) — required, max 100 chars.

Email — required, valid email.

Password — required, min 8 chars, show toggle visibility.

Confirm Password — required, must match password.

Submit button — disabled while submitting.

Small text: “Already have account? Login” link.

API contract

POST ${VITE_API_BASE}/auth/register body:

{ "name": "Alice", "email": "alice@example.com", "password": "password123" }


Expect 201 or 200 success. If server returns accessToken & user, call setAuth.

Behaviour & validations

Client-side validate fields before sending.

Show inline field errors.

On submit:

Disable form + show spinner on button.

Call API, handle success/failure.

If success and tokens returned: authStore.setAuth({ user, token }) and redirect to /dashboard.

If no tokens returned, redirect to /auth/login and show toast “Registration successful — please login”.

Handle server errors: show message returned by API (email already exists, etc.)

Accessibility:

aria-invalid for invalid fields.

Labels associated with inputs.

Keyboard navigable (Enter to submit).

Responsive

Centered card on mobile (full width with padding), on desktop show card in middle with width max-w-md.

Acceptance tests

Can create a user with valid inputs → redirected to dashboard (or login).

Shows validation error if email invalid / password mismatch.

Displays server-side error for duplicate email.

3 — Login page (/auth/login)
Purpose

Authenticate registered users, store token, and open dashboard.

Components & files

src/pages/auth/Login.tsx

Reuse AuthForm.tsx and Input, Button.

Form fields & UI

Email — required

Password — required, visibility toggle

Remember me checkbox (optional) — if true, persist token in localStorage; else store in memory only

Login button

Links: Register, Forgot password (if implemented)

Show 2FA input field when server indicates 2FA required (on initial login response).

API contract

POST ${VITE_API_BASE}/auth/login body:

{ "email": "alice@example.com", "password": "secret" }


If 2FA enabled: backend may respond with 401 + twoFactorRequired or a specific status — implement handling:

Prompt for one-time code field and re-submit: { email, password, code }

Successful response returns { accessToken, refreshToken? , user }.

Behaviour

On submit: set loading, call API.

On success: call authStore.setAuth, navigate to /dashboard.

On 2FA required: show code input and send code along with login payload.

On error: show toast + inline messages.

Accessibility:

aria-label, proper focus management: focus first invalid input if error.

After successful login focus dashboard main heading.

Acceptance tests

Valid credentials → redirect to /dashboard and store token.

Invalid credentials show proper error.

2FA flow works: user prompted for code and login succeeds after code.

4 — Dashboard (/dashboard or / protected)
Purpose

Main logged-in area showing user files summary, quick actions, and left sidebar with user name + menu.

Components & files

src/pages/dashboard/Dashboard.tsx

src/components/AppShell.tsx (Topbar + LeftNav + Main content)

src/components/LeftNav.tsx

src/components/Topbar.tsx

src/components/QuickUpload.tsx

src/components/StatsCard.tsx

src/components/FileList.tsx (shared with Drive)

Left sidebar (LeftNav) details

Top: User avatar (initials if no avatar) + User's name and small email

Menu (vertical): Dashboard (overview), Drive (files), Upload, Folders, Tags, Search, Settings, Logout

Each menu item: icon + label, keyboard focusable, active state highlight

Responsive: collapsible on small screens (hamburger to toggle), on mobile a bottom nav is acceptable

Dashboard main area

Header: Welcome, <User.name> and quick actions (Upload, New Folder)

Cards row: total files, storage used, recent uploads count

Recent files list (FileList) showing last 6 files with preview, name, size, date, actions (preview/download/delete)

Quick uploader: drag & drop area or small modal (re-use Uploader component)

Data & API calls

GET ${VITE_API_BASE}/api or specific endpoints:

GET /api/documents?limit=6&sort=recent

GET /api/stats (admin only) or GET /api/users/:id/stats

When clicking Upload:

Use same presign flow: POST /api/documents → uploadUrl → PUT upload → PUT /api/documents/:id/complete

Logout:

Clear auth store, clear tokens, redirect to /auth/login.

Optionally call POST /api/auth/logout if implemented.

Behaviour & UX

Loading state skeletons for cards & list.

Clicking file preview opens preview panel (right side or modal).

Bulk select checkboxes (basic).

Confirm dialogs for destructive actions.

Accessibility:

Sidebar nav uses <nav> and aria-current for active item.

All buttons have aria-label.

Focus trap for upload modal & preview modal.

Responsive rules

Desktop: left sidebar visible, 3-column layout for cards + list + preview panel.

Tablet: left nav collapses to icons, preview modal overlays.

Mobile: left nav hidden under hamburger; main uses vertical stacking.

Acceptance tests

Dashboard loads when authenticated.

Recent files display correct metadata.

Quick upload completes end-to-end (presign → upload → complete).

Logout clears auth and redirects to login.

5 — LeftNav menu behaviour & tasks (detailed)

Implement LeftNav props:

interface LeftNavProps {
  user: User;
  active: 'dashboard'|'drive'|'folders'|'tags'|'settings'|'admin';
  onNavigate: (route:string) => void;
}


Menu items:

Dashboard (/dashboard)

Drive (/drive)

Upload (opens upload modal)

Folders (/folders)

Tags (/tags)

Search (/search)

Settings (/settings)

Admin (visible only if user.role === 'admin')

Logout (calls authStore.clearAuth() and redirect)

Accessibility:

Each item is a button or NavLink with aria-current="page" when active.

Keyboard navigation: up/down arrow keys move focus.

Responsive:

Collapsed variant: show icons only; tooltip on hover.

Mobile: full-screen menu.

6 — Routing plan

/auth/register — Register page

/auth/login — Login page

/dashboard — Dashboard (protected)

/drive — File manager (protected)

/documents/:id — Document detail (protected)

/folders/:id — Folder view (protected)

/settings — profile & theme (protected)

Use PrivateRoute wrapper for protected routes.

7 — Security & UX considerations

Never store refresh token in localStorage; backend should set httpOnly cookie for refresh token. Access token can be in memory or localStorage (you chose).

Use HTTPS in production.

Rate-limit login attempts in backend (already done).

Validate file size / type client-side using environment MAX_FILE_SIZE and ALLOWED_FILE_TYPES if accessible.

8 — Tests to implement

Unit tests (Vitest):

useAuth store tests (login/set/clear).

validators tests (email, password match).

ThemeProvider tests (persistence).

Integration / E2E (Playwright):

Register -> Login -> Dashboard -> Upload -> Preview (happy path)

Login with wrong password shows error

2FA login flow

Logout works

9 — UI polish & accessibility checklist (final acceptance)

All forms have labels and aria-* attributes.

Color contrast meets WCAG AA for normal text.

Keyboard navigation tested for sidebar, modals, and upload form.

Focus management: after navigation focus top heading; after modal close return focus to opener.

Mobile layout is usable (touch targets >= 44px).

Error states show helpful messages and retry options.

10 — Example small implementation tasks (atomic, for commits)

Create src/lib/api.ts axios client and export.

Create src/stores/authStore.ts.

Implement AuthForm component + Input + Button.

Implement Register page with client validation and API call.

Implement Login page with 2FA handling.

Create AppShell and LeftNav UI + responsive CSS.

Implement Dashboard skeleton and GET /documents?limit=6.

Implement Uploader component and integrate presign flow.

Add route guards and wire routes.

Add tests for register/login flows.